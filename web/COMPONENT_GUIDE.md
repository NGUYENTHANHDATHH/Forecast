# Component Development Guide

## üìñ H∆∞·ªõng d·∫´n ph√°t tri·ªÉn Component

T√†i li·ªáu n√†y cung c·∫•p h∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ c√°ch ph√°t tri·ªÉn, t·ªï ch·ª©c v√† b·∫£o tr√¨ components trong Smart Forecast Web Frontend.

## üéØ Component Types

### 1. Layout Components

Components ƒë·ªãnh nghƒ©a c·∫•u tr√∫c chung c·ªßa trang.

**Location:** `src/components/layouts/`

**Examples:**

- `Header` - Top navigation bar
- `Sidebar` - Side navigation menu
- `Footer` - Page footer

**Characteristics:**

- Xu·∫•t hi·ªán tr√™n nhi·ªÅu pages
- Ch·ª©a navigation logic
- Qu·∫£n l√Ω layout state (sidebar open/close)

**Example:**

```tsx
// components/layouts/Header/Header.tsx
interface HeaderProps {
  sidebarOpen: boolean;
  setSidebarOpen: (open: boolean) => void;
  onNavigate: (page: string) => void;
}

export function Header({ sidebarOpen, setSidebarOpen, onNavigate }: HeaderProps) {
  return (
    <header className="fixed top-0 left-0 right-0 h-14 bg-white border-b">
      <MenuToggle isOpen={sidebarOpen} onToggle={() => setSidebarOpen(!sidebarOpen)} />
      <Logo />
      <NotificationButton onViewAll={() => onNavigate('notifications')} />
      <UserMenu onNavigate={onNavigate} />
    </header>
  );
}
```

### 2. Feature Components

Components thu·ªôc v·ªÅ m·ªôt feature c·ª• th·ªÉ.

**Location:** `src/features/[feature-name]/components/`

**Examples:**

- `LoginForm` - Auth feature
- `DashboardOverview` - Dashboard feature
- `AlertsList` - Alerts feature

**Characteristics:**

- Specific to one feature
- Can use feature-specific hooks
- May call feature-specific services

**Example:**

```tsx
// features/dashboard/components/DashboardOverview.tsx
export function DashboardOverview() {
  const { data, loading } = useDashboardData();

  if (loading) return <PageLoader />;

  return (
    <div className="space-y-4">
      <PageHeader title="Dashboard" description="System overview" />
      <SummaryCards data={data.summary} />
      <RecentReports reports={data.reports} />
    </div>
  );
}
```

### 3. Shared Components

Components t√°i s·ª≠ d·ª•ng xuy√™n su·ªët application.

**Location:** `src/components/shared/`

**Examples:**

- `LoadingSpinner` - Loading indicator
- `ErrorMessage` - Error display
- `EmptyState` - No data state
- `PageHeader` - Page title & actions

**Characteristics:**

- Highly reusable
- Generic and configurable
- No business logic

**Example:**

```tsx
// components/shared/EmptyState/EmptyState.tsx
interface EmptyStateProps {
  icon?: LucideIcon;
  title: string;
  description?: string;
  action?: React.ReactNode;
}

export function EmptyState({ icon: Icon = Inbox, title, description, action }: EmptyStateProps) {
  return (
    <div className="flex flex-col items-center justify-center py-12">
      <Icon className="h-8 w-8 text-slate-400 mb-4" />
      <h3 className="text-slate-900 font-semibold">{title}</h3>
      {description && <p className="text-slate-500 text-sm">{description}</p>}
      {action}
    </div>
  );
}
```

### 4. UI Components

Base UI components t·ª´ shadcn/ui.

**Location:** `src/components/ui/`

**Examples:**

- `Button`
- `Card`
- `Dialog`
- `Input`

**Characteristics:**

- Generated by shadcn/ui CLI
- Kh√¥ng n√™n ch·ªânh s·ª≠a tr·ª±c ti·∫øp
- Customize qua props v√† className

## üìã Component Structure Template

### Basic Component

```tsx
// 1. Imports - External first, then internal
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { cn } from '@/lib/utils';

// 2. Types/Interfaces
interface MyComponentProps {
  title: string;
  description?: string;
  onAction?: () => void;
  className?: string;
}

// 3. Component
export function MyComponent({ title, description, onAction, className }: MyComponentProps) {
  // 4. State
  const [isActive, setIsActive] = useState(false);

  // 5. Effects
  useEffect(() => {
    // Side effects
  }, []);

  // 6. Event Handlers
  const handleClick = () => {
    setIsActive(!isActive);
    onAction?.();
  };

  // 7. Render
  return (
    <div className={cn('p-4', className)}>
      <h3>{title}</h3>
      {description && <p>{description}</p>}
      <Button onClick={handleClick}>{isActive ? 'Active' : 'Inactive'}</Button>
    </div>
  );
}
```

### Component with Custom Hook

```tsx
// hooks/useMyFeature.ts
export function useMyFeature() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);

  const fetchData = async () => {
    setLoading(true);
    try {
      const result = await api.getData();
      setData(result);
    } finally {
      setLoading(false);
    }
  };

  return { data, loading, fetchData };
}

// components/MyComponent.tsx
export function MyComponent() {
  const { data, loading, fetchData } = useMyFeature();

  useEffect(() => {
    fetchData();
  }, []);

  if (loading) return <LoadingSpinner />;
  if (!data) return <EmptyState title="No data" />;

  return <div>{/* Render data */}</div>;
}
```

## üé® Component Patterns

### 1. Container/Presentational Pattern

T√°ch logic v√† UI:

```tsx
// Container - Logic
function UserListContainer() {
  const { users, loading, error } = useUsers();

  if (loading) return <PageLoader />;
  if (error) return <ErrorMessage message={error} />;

  return <UserListPresentation users={users} />;
}

// Presentational - UI only
interface UserListPresentationProps {
  users: User[];
}

function UserListPresentation({ users }: UserListPresentationProps) {
  return (
    <div className="space-y-2">
      {users.map((user) => (
        <UserCard key={user.id} user={user} />
      ))}
    </div>
  );
}
```

### 2. Compound Components Pattern

Components ho·∫°t ƒë·ªông c√πng nhau:

```tsx
// Card compound component
function Card({ children }: { children: React.ReactNode }) {
  return <div className="rounded-lg border p-4">{children}</div>;
}

function CardHeader({ children }: { children: React.ReactNode }) {
  return <div className="mb-4 border-b pb-2">{children}</div>;
}

function CardContent({ children }: { children: React.ReactNode }) {
  return <div>{children}</div>;
}

// Usage
<Card>
  <CardHeader>Title</CardHeader>
  <CardContent>Content</CardContent>
</Card>;
```

### 3. Render Props Pattern

```tsx
interface DataFetcherProps<T> {
  url: string;
  children: (data: T | null, loading: boolean) => React.ReactNode;
}

function DataFetcher<T>({ url, children }: DataFetcherProps<T>) {
  const [data, setData] = useState<T | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetch(url)
      .then((res) => res.json())
      .then(setData)
      .finally(() => setLoading(false));
  }, [url]);

  return <>{children(data, loading)}</>;
}

// Usage
<DataFetcher<User[]> url="/api/users">
  {(users, loading) => (loading ? <LoadingSpinner /> : <UserList users={users} />)}
</DataFetcher>;
```

### 4. Higher-Order Component (HOC)

```tsx
function withAuth<P extends object>(Component: React.ComponentType<P>) {
  return function AuthenticatedComponent(props: P) {
    const { user, loading } = useAuth();

    if (loading) return <PageLoader />;
    if (!user) redirect('/login');

    return <Component {...props} />;
  };
}

// Usage
const ProtectedDashboard = withAuth(Dashboard);
```

## üîß Component Guidelines

### Props Design

```tsx
// ‚úÖ GOOD - Clear, typed props
interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'ghost';
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  loading?: boolean;
  onClick?: () => void;
  children: React.ReactNode;
}

// ‚ùå BAD - Unclear, any types
interface ButtonProps {
  type?: string;
  config?: any;
  onClick?: Function;
}
```

### Default Props

```tsx
// ‚úÖ GOOD - Use default parameters
function Button({ variant = 'primary', size = 'md', disabled = false, ...props }: ButtonProps) {
  // ...
}

// ‚ùå BAD - Old style
Button.defaultProps = {
  variant: 'primary',
  size: 'md',
};
```

### Conditional Rendering

```tsx
// ‚úÖ GOOD - Early returns
function UserProfile({ user }: { user: User | null }) {
  if (!user) return <EmptyState title="No user" />;

  return (
    <div>
      <h1>{user.name}</h1>
      <p>{user.email}</p>
    </div>
  );
}

// ‚ùå BAD - Nested ternaries
function UserProfile({ user }: { user: User | null }) {
  return (
    <div>
      {user ? (
        <div>
          <h1>{user.name}</h1>
          {user.email ? <p>{user.email}</p> : null}
        </div>
      ) : (
        <EmptyState title="No user" />
      )}
    </div>
  );
}
```

### Event Handlers

```tsx
// ‚úÖ GOOD - Clear naming
const handleSubmit = () => {};
const handleUserClick = (userId: string) => {};
const handleInputChange = (value: string) => {};

// ‚ùå BAD - Unclear naming
const submit = () => {};
const click = (id: string) => {};
const change = (val: string) => {};
```

## üì¶ Component Organization

### Folder Structure

```
ComponentName/
‚îú‚îÄ‚îÄ ComponentName.tsx         # Main component
‚îú‚îÄ‚îÄ SubComponent1.tsx         # Sub-components
‚îú‚îÄ‚îÄ SubComponent2.tsx
‚îú‚îÄ‚îÄ index.ts                  # Exports
‚îú‚îÄ‚îÄ types.ts                  # Component types (if complex)
‚îú‚îÄ‚îÄ utils.ts                  # Component utilities (if any)
‚îî‚îÄ‚îÄ ComponentName.test.tsx    # Tests (if needed)
```

### Index File

```tsx
// index.ts
export { ComponentName } from './ComponentName';
export { SubComponent1 } from './SubComponent1';
export type { ComponentNameProps } from './ComponentName';
```

### Usage

```tsx
// Other files can import
import { ComponentName, SubComponent1 } from '@/components/ComponentName';
```

## üéØ Common Patterns

### Loading States

```tsx
function DataComponent() {
  const { data, loading, error } = useData();

  if (loading) return <PageLoader message="Loading data..." />;
  if (error) return <ErrorMessage message={error} />;
  if (!data || data.length === 0) {
    return <EmptyState title="No data" description="Try adding some items" />;
  }

  return <div>{/* Render data */}</div>;
}
```

### Form Handling

```tsx
function MyForm() {
  const [formData, setFormData] = useState({
    email: '',
    password: '',
  });
  const [errors, setErrors] = useState<Record<string, string>>({});
  const [loading, setLoading] = useState(false);

  const validate = () => {
    const newErrors: Record<string, string> = {};
    if (!formData.email) newErrors.email = 'Email is required';
    if (!formData.password) newErrors.password = 'Password is required';
    return newErrors;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    const newErrors = validate();
    if (Object.keys(newErrors).length > 0) {
      setErrors(newErrors);
      return;
    }

    setLoading(true);
    try {
      await submitForm(formData);
      toast.success('Success!');
    } catch (error) {
      toast.error('Failed to submit');
    } finally {
      setLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <Input
        value={formData.email}
        onChange={(e) => setFormData((prev) => ({ ...prev, email: e.target.value }))}
        error={errors.email}
      />
      {/* More fields */}
      <Button type="submit" loading={loading}>
        Submit
      </Button>
    </form>
  );
}
```

### Modal/Dialog

```tsx
function DeleteUserDialog({ user, onClose, onConfirm }: DeleteUserDialogProps) {
  const [loading, setLoading] = useState(false);

  const handleConfirm = async () => {
    setLoading(true);
    try {
      await deleteUser(user.id);
      toast.success('User deleted');
      onConfirm();
      onClose();
    } catch (error) {
      toast.error('Failed to delete user');
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open onOpenChange={onClose}>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Delete User</DialogTitle>
          <DialogDescription>Are you sure you want to delete {user.name}?</DialogDescription>
        </DialogHeader>
        <DialogFooter>
          <Button variant="outline" onClick={onClose} disabled={loading}>
            Cancel
          </Button>
          <Button variant="destructive" onClick={handleConfirm} loading={loading}>
            Delete
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}
```

### List with Actions

```tsx
function UserList() {
  const { users, deleteUser } = useUsers();
  const [selectedUser, setSelectedUser] = useState<User | null>(null);

  return (
    <>
      <div className="space-y-2">
        {users.map((user) => (
          <Card key={user.id}>
            <div className="flex items-center justify-between">
              <div>
                <h3>{user.name}</h3>
                <p>{user.email}</p>
              </div>
              <Button variant="ghost" onClick={() => setSelectedUser(user)}>
                Delete
              </Button>
            </div>
          </Card>
        ))}
      </div>

      {selectedUser && (
        <DeleteUserDialog
          user={selectedUser}
          onClose={() => setSelectedUser(null)}
          onConfirm={() => deleteUser(selectedUser.id)}
        />
      )}
    </>
  );
}
```

## ‚úÖ Checklist khi t·∫°o Component m·ªõi

- [ ] Component name r√µ r√†ng, m√¥ t·∫£ ch·ª©c nƒÉng
- [ ] Props interface ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a ƒë·∫ßy ƒë·ªß
- [ ] Default values cho optional props
- [ ] Loading v√† error states ƒë∆∞·ª£c x·ª≠ l√Ω
- [ ] Accessibility: aria labels, keyboard navigation
- [ ] Responsive design v·ªõi Tailwind breakpoints
- [ ] TypeScript strict mode kh√¥ng c√≥ l·ªói
- [ ] Reusable v√† kh√¥ng ch·ª©a hard-coded values
- [ ] Comments cho logic ph·ª©c t·∫°p
- [ ] Exports trong index.ts

## üö´ Common Mistakes

### 1. Too Many Props

```tsx
// ‚ùå BAD - Props explosion
<Component
  prop1={value1}
  prop2={value2}
  prop3={value3}
  prop4={value4}
  prop5={value5}
  prop6={value6}
/>

// ‚úÖ GOOD - Group related props
<Component config={{ prop1, prop2, prop3 }} actions={{ prop4, prop5, prop6 }} />
```

### 2. Prop Drilling

```tsx
// ‚ùå BAD - Passing props through many levels
<Parent>
  <Child1 user={user}>
    <Child2 user={user}>
      <Child3 user={user} />
    </Child2>
  </Child1>
</Parent>

// ‚úÖ GOOD - Use Context
<UserContext.Provider value={user}>
  <Parent>
    <Child1>
      <Child2>
        <Child3 /> {/* Uses useUser() hook */}
      </Child2>
    </Child1>
  </Parent>
</UserContext.Provider>
```

### 3. Large Components

```tsx
// ‚ùå BAD - 500+ lines component
function Dashboard() {
  // Tons of state
  // Lots of logic
  // Huge JSX
}

// ‚úÖ GOOD - Break into smaller components
function Dashboard() {
  return (
    <>
      <DashboardHeader />
      <DashboardSummary />
      <DashboardCharts />
      <DashboardReports />
    </>
  );
}
```

## üìö Resources

- [React Patterns](https://reactpatterns.com/)
- [Component-Driven Development](https://www.componentdriven.org/)
- [React TypeScript Cheatsheet](https://react-typescript-cheatsheet.netlify.app/)

---

**C·∫≠p nh·∫≠t l·∫ßn cu·ªëi:** November 24, 2025
